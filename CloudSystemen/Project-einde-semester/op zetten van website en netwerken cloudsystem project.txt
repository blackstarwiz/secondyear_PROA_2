Virtuele machine opzetten (dit is waar de bestanden van de website/applicatie staan)
1.1 Maak een Linux VM in Azure (Ubuntu 22.04 LTS, size B2s of klein, West Europe of Germany West Central voor lage latency).
1.1.1 Stel SSH in met public en private key (gemaakt op je lokale machine, niet op VM; gebruik ssh-keygen, upload public key naar Azure Portal bij VM creatie).
1.1.2 Maak het public IP static (in Azure Portal → Networking → IP configurations → Allocation method: Static) om te voorkomen dat het IP verandert.
1.1.3 Log in via SSH (ssh azureuser@20.218.124.27 – vervang username en IP).
1.1.4 Update VM software (sudo apt update && sudo apt upgrade -y).
1.1.5 Installeer tools (sudo apt install curl wget git -y).
1.1.6 Installeer Docker (officiële script: curl -fsSL https://get.docker.com -o get-docker.sh && sh get-docker.sh).
1.1.7 Stel Docker in zodat sudo niet nodig is (sudo usermod -aG docker $USER; log uit/in).
1.1.8 Maak een project map aan (mkdir ~/cloudproject && cd ~/cloudproject).
1.1.9 Maak docker-compose.yml (voor Caddy + app; zie repo voor volledige inhoud: services caddy en app, met volumes voor persistentie, ports 80/443, build voor app).
Domeinnaam koppelen aan hosting (DuckDNS)
2.1 Maak een account aan op duckdns.org (log in met Google/GitHub).
2.2 Vul een unieke subdomain in (bijv. jason-docker-project).
2.3 Vul het static public IP in van de VM (20.218.124.27).
2.4 Update IP in DuckDNS dashboard; test met ping jason-docker-project.duckdns.org (moet IP tonen, packets terugsturen komt later met webserver).
Poorten forwarden: open inbound ports in Azure NSG
3.1 Ga naar Azure Portal → VM → Networking → Inbound port rules.
3.2 Voeg regels toe: HTTP (poort 80, TCP, Allow from Any), HTTPS (poort 443, TCP, Allow from Any).
3.3 Protocol specifiek kiezen (TCP i.p.v. Any) om issues te vermijden; priority laag (bijv. 320/330).
Webapp creëren (Node.js met Express + SQLite counter)
4.1 Maak app/ map in ~/cloudproject.
4.2 Maak Dockerfile in app/ (FROM node:20-alpine, WORKDIR /app, COPY, RUN npm install, RUN mkdir -p db, EXPOSE 3000, CMD npm start).
4.3 Maak package.json in app/ (dependencies: express, sqlite3, ejs, body-parser; scripts: start = node server.js).
4.4 Maak server.js in app/ (require express/sqlite3/path/body-parser; setup DB in db/visits.db met visits tabel; views met EJS; static voor /assets en /public; GET / voor counter; POST /reset voor reset naar 0; listen op 3000).
4.5 Maak site.ejs in app/ (HTML template met <% visits %>, link naar /site.css en /reset.js, button id="reset").
4.6 Maak public/ map met site.css (body/h1/counter/button styling, hover/active effects op button) en reset.js (click event met confirm, fetch POST /reset, reload bij succes).
4.7 Maak assets/ map met favicon.ico (download via wget of upload; link in ejs met <link rel="icon" href="/assets/favicon.ico">).
Reverse proxy en HTTPS instellen (Caddy)
5.1 Maak Caddyfile in root (domeinnaam { reverse_proxy app:3000 }).
5.2 Update docker-compose.yml met caddy service (depends_on app; volumes voor Caddyfile/data/config).
5.3 Start alles (docker compose up -d --build); test HTTPS site.
GitHub repo en auto-deploy
6.1 Maak private repo op GitHub (bijv. cloudproject-docker).
6.2 Voeg pietervdvn toe als contributor (Settings → Manage access).
6.3 Maak .gitignore (ignore volumes/db/node_modules).
6.4 Voeg LICENSE toe (MIT).
6.5 Maak .github/workflows/deploy.yml (on push main: checkout, SSH naar VM, git pull, docker compose up -d --build).
6.6 Genereer SSH-key voor deploy (ssh-keygen -f ~/deploy_key; voeg pub key toe aan Azure VM; private key als secret SSH_PRIVATE_KEY in GitHub Secrets).
6.7 Push code (git add/commit/push); test workflow door push – deployt automatisch.